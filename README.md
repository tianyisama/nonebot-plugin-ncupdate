# nonebot-plugin-ncupdate
ç®¡ç†ncçš„è‡ªåŠ¨æ‡’äººæ’ä»¶

# âš è­¦å‘Š
æœ¬æ’ä»¶å«æœ‰å¤§é‡å±å±±ä»£ç 

è°¨è®°éå¿…è¦ä¸æ›´æ–°çš„é“ç†

å»ºè®®éƒ½æ›´æ–°åˆ°2.4.6åŠä»¥ä¸Šçš„napcatç‰ˆæœ¬ï¼Œç„¶åä½¿ç”¨ä¸‹æ–¹çœæµç‰ˆå®‰è£…

Linuxå»ºè®®ä½¿ç”¨ä¸€é”®è„šæœ¬ï¼Œå› ä¸ºæ‰‹åŠ¨å®‰è£…å¾ˆéº»çƒ¦ï¼Œå¿«é€Ÿéƒ¨ç½²æ–¹å¼è¯¦è§[Napcatå®˜æ–¹æ–‡æ¡£](https://napcat.napneko.icu/guide/boot/Shell)

ä¸æƒ³ç‚¹è¿›å»ï¼Ÿçƒçƒä½ äº†ï¼Œå»çœ‹çœ‹å§ï¼Œé›ªé›ªçœŸçš„å¾ˆå¯çˆ±~

<details>
<summary>ä¸çœ‹ä¸çœ‹å§ğŸ˜­ğŸ˜­ğŸ˜­</summary>
ä½¿ç”¨ä»¥ä¸‹ä»£ç å®‰è£…napcat(Linux ä¸€é”®è„šæœ¬(é€‚ç”¨äº Ubuntu 20+/Debian 10+/Centos 9))

    curl -o napcat.sh https://nclatest.znin.net/NapNeko/NapCat-Installer/main/script/install.sh && sudo bash napcat.sh
    

</details>

linuxæ–­çº¿é‡è¿ä»…æ”¯æŒxvfbæ³•å¯åŠ¨çš„ã€screençª—å£åä¸ºnapcatçš„æ–¹å¼

å¦‚æœä½ ä¸æ‡‚ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹ä»£ç æ¥å¯åŠ¨napcat(å…¶ä¸­123456789æ›¿æ¢ä¸ºä½ å®é™…çš„æœºå™¨äººè´¦å·)

`screen -dmS napcat bash -c "xvfb-run -a qq --no-sandbox -q 123456789"`

## ä¸æƒ³çœ‹ä¸€é•¿ä¸²çš„çœæµç‰ˆ
<details>
<summary>Windows</summary>
    
- ä¸è¦ä½¿ç”¨server2012ï¼Œæ¢ä¸ªæ–°ç‚¹çš„ç³»ç»Ÿ
- ç¡®ä¿QQç‰ˆæœ¬å¤§äºç­‰äº[28060](https://dldir1.qq.com/qqfile/qq/QQNT/592d67a6/QQ9.9.16.29271_x64.exe)
- ä¸‹è½½[napcatæ–°ç‰ˆ](https://github.com/NapNeko/NapCatQQ/releases/download/v3.6.5/NapCat.Shell.zip)åˆ°Cç›˜ï¼ˆè®°å¾—ä¸‹è½½napcat.shellçš„ç‰ˆæœ¬ï¼‰
- è§£å‹napcatå‹ç¼©åŒ…ï¼Œç¡®ä¿C:\NapCat.Shellä¸‹å°±æ˜¯napcatçš„æ–‡ä»¶ï¼Œæ¯”å¦‚å«æœ‰napcat.mjsè¿™ä¸ªæ–‡ä»¶
- å¡«å†™nbçš„.env.*æ–‡ä»¶ï¼ˆå¦‚æœæ˜¯win10ï¼Œnc_restart_wayå€¼ä¸º5ï¼Œwin11å°±å†™6ï¼‰
```ini
base_path=C:\\
topfolder=NapCat.Shell
napcat_mode=win
nc_reconnect=true
nc_restart_way=5
```
- æŒ‰ç…§nbå’Œncçš„å¯åŠ¨æ–¹å¼å¯åŠ¨è¿æ¥å³å¯æ­£å¸¸ä½¿ç”¨
- æœ‰æ›´å¤šéœ€æ±‚ï¼Œæ¯”å¦‚éœ€è¦é…ç½®ä»£ç†å¯ä»¥å¾€åçœ‹é…ç½®é¡¹
</details>

<details>
<summary>Linux</summary>
    
- ä¸è¦ä½¿ç”¨centos7æˆ–8ï¼Œæ¢ä¸ªæ–°ç‚¹çš„ç³»ç»Ÿæ¯”å¦‚Ubuntu
- ä½¿ç”¨ä¸€é”®å®‰è£…è„šæœ¬`curl -o napcat.sh https://nclatest.znin.net/NapNeko/NapCat-Installer/main/script/install.sh && sudo bash napcat.sh`æ˜¯å¦ä½¿ç”¨shellå®‰è£…é€‰æ‹©æ˜¯(y)
- å¡«å†™nbçš„.env.*æ–‡ä»¶
```ini
base_path=/opt/QQ/resources/app/app_launcher
topfolder=napcat
napcat_mode=linux
nc_reconnect=true
nc_restart_way=7
```
- æŒ‰ç…§nbå’Œncçš„å¯åŠ¨æ–¹å¼å¯åŠ¨è¿æ¥å³å¯æ­£å¸¸ä½¿ç”¨
- æœ‰æ›´å¤šéœ€æ±‚ï¼Œæ¯”å¦‚éœ€è¦é…ç½®ä»£ç†å¯ä»¥å¾€åçœ‹é…ç½®é¡¹
</details>

<details>
<summary>termux</summary>
    
- æ²¡è¯•è¿‡ä¸çŸ¥é“

</details>

## å¸¸è§é—®é¢˜
<details>
<summary>1.æˆ‘ç”¨çš„Linuxä¸€é”®å®‰è£…è„šæœ¬ï¼Œä¸çŸ¥é“napcatå®‰è£…åœ¨å“ªé‡Œ</summary>
    
ä¸€èˆ¬æ¥è¯´åœ¨/opt/QQ/resources/app/app_launcher/napcatï¼Œå¦‚æœæ˜¯è¿™æ ·çš„è¯ï¼Œbase_pathå¡«å†™/opt/QQ/resources/app/app_launcherï¼Œtopfolderå¡«å†™napcatå³å¯
    
</details>

<details>
<summary>2.æˆ‘å‘æŒ‡ä»¤æ²¡ååº”</summary>
    
è¯·æ£€æŸ¥ä½ æ˜¯å¦åœ¨.env.*ä¸­å¡«å†™äº†æ­£ç¡®çš„superuserså’Œcommand_start
    
</details>

<details>
<summary>3.æŒ‡ä»¤å¤ªå¤šè®°ä¸ä½</summary>
    
å‘é€ncå¸®åŠ©æŸ¥çœ‹æ‰€æœ‰æŒ‡ä»¤

</details>


## æ›´æ–°
### 11.15
- é€‚é…äº†v4åŠå…¶ä»¥åçš„ç‰ˆæœ¬ï¼ˆå¤§æ¦‚ï¼‰~~æ€ä¹ˆæ›´æ–°è¿™ä¹ˆå¿«å•Š~~
- ä¼˜åŒ–æ‰äº†ä¸¤è¡Œç­”è¾©
### 10.19
- æ·»åŠ äº†v3çš„é€‚é…
### 10.8
- æ–°å¢Linuxæ–­çº¿é‡è¿
- å¢åŠ äº†æ–­çº¿çŸ­æš‚ç­‰å¾…ï¼Œä»¥é˜²åè®®ç«¯æŠ½é£é€ æˆçŸ­æ—¶é—´å†…é‡è¿å¼•èµ·çš„æ­»å¾ªç¯
### 10.6
- Windowsæ–­çº¿é‡è¿æ”¯æŒæ‰€æœ‰æ–¹å¼ï¼ˆé™¤äº†1ï¼‰
- é‡å¡‘äº†éƒ¨åˆ†å²çš„å½¢çŠ¶
### 10.5
- æ·»åŠ äº†2.4.6åŠä»¥ä¸Šç‰ˆæœ¬çš„ç™»é™†æ–¹å¼ï¼ˆlauncher.batç™»å½•æ³•ï¼‰
### 10.1
- æ·»åŠ äº†LinuxæŸ¥çœ‹qqç‰ˆæœ¬ï¼ˆæ”¯æŒUbuntuï¼ŒCentosï¼ŒRockyï¼ŒDebianï¼‰
### 9.16
- æ·»åŠ äº†2.xç‰ˆæœ¬çš„é€‚é…
- ç§»é™¤äº†é…ç½®é¡¹`nc_http_port`ï¼Œæ–°å¢äº†é…ç½®é¡¹`nc_restart_way` `nc_self_qq_version` `nc_self_restart`
- æ–°å¢äº†æŒ‡ä»¤`ncæ£€æŸ¥æ›´æ–°` `æŸ¥çœ‹qq/QQç‰ˆæœ¬` `æŸšå­æ£€æŸ¥æ›´æ–°` `æŸšå­æŸ¥çœ‹qqç‰ˆæœ¬`ï¼ŒæŒ‡ä»¤`(æŸšå­)æ›´æ–°nc`æ–°å¢å¯æŒ‡å®šç‰ˆæœ¬ï¼Œä¾‹å¦‚`(æŸšå­)æ›´æ–°nc1.8.2`
- æ–°å¢å†…ç½®åˆ¤æ–­napcatæ˜¯å¦ä¸ntqqå…¼å®¹ï¼Œä¸å…¼å®¹ä¼šç»ˆæ­¢æ›´æ–°
- æ–°å¢å¤šç§å¯é€‰çš„å¯åŠ¨æ–¹å¼
### 7.29
- ç”±äºnbç«¯æ”¹ä»£ç å¯¼è‡´çš„reloadä¹Ÿä¼šè§¦å‘é‡è¿ï¼Œè€Œä¸”è¢«ç¡¬æ§åç§’(nbä¼šåœ¨æ‰§è¡Œå®Œä»£ç åå†å…³é—­)ã€‚æ¬¸ğŸ¤“ğŸ‘†ï¼Œæˆ‘æœ‰ä¸ªå¥½ç‚¹å­
- æ·»åŠ äº†è‡ªåŠ¨é‡è¿çš„çª—å£ï¼Œå¯é€‰æ‹©æ˜¯å¦ç«‹å³é‡å¯æˆ–å–æ¶ˆé‡å¯
### 7.14
- é€‚é…äº†9.9.12ç‰ˆæœ¬çš„ntqq
### 6.28
- ä¿®å¤äº†ç”±äºncçªç„¶æ”¯æŒwin32å¯¼è‡´çš„win64ä½ä¸‹è½½å‡ºé”™çš„é—®é¢˜. ~~è¯´å¥½çš„æ²¡æœ‰æ”¯æŒwin32çš„æ‰“ç®—å‘¢(è¯è¯´çœŸçš„è¿˜æœ‰äººåœ¨ç”¨win32å—)~~
- æ–°å¢winç³»ç»Ÿcmdé—ªé€€å‘èµ·é‡è¿ï¼ˆæ‰‹åŠ¨å…³æ‰cmdä¹Ÿä¼šè§¦å‘é‡è¿è¯·æ±‚ï¼‰
- æ–°å¢æ–­çº¿10såå†å‘èµ·é‡è¿

## å®‰è£…
<details>
<summary>ä½¿ç”¨nb-cliå®‰è£…(æ¨è)</summary>


    nb plugin install nonebot-plugin-ncupdate
    

</details>

<details>
<summary>ä½¿ç”¨PIPå®‰è£…</summary>


    pip install nonebot-plugin-ncupdate
    
è‹¥å®‰è£…äº†è™šæ‹Ÿç¯å¢ƒï¼Œè¯·åœ¨è™šæ‹Ÿç¯å¢ƒä¸­æ“ä½œã€‚å®‰è£…å®Œæˆåï¼Œè¯·åœ¨ä½ çš„`bot.py`æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç æ¥å¯¼å…¥æ’ä»¶ï¼š
 `nonebot.load_plugin("nonebot_plugin_ncupdate")`
</details>

## è¯´æ˜


æ”¯æŒè‡ªèº«è§¦å‘æ›´æ–°æˆ–é‡å¯ï¼Œæ”¯æŒé€‰æ‹©ä»£ç†ï¼Œæ”¯æŒè·å–QQç‰ˆæœ¬ä¸”è‡ªè¡Œåˆ¤æ–­æ˜¯å¦é€‚ç”¨æ–°ç‰ˆnapcatï¼ˆç›®å‰åˆ¤æ–­åˆ°QQç‰ˆæœ¬ã€28060ã€‘é™„è¿‘ï¼‰

æ”¯æŒæ–­çº¿é‡è¿ï¼ˆé»˜è®¤å…³é—­ï¼Œ~~ç›®å‰ä»…æ”¯æŒWindowsï¼Œä¸”åªæ”¯æŒåˆç‰ˆbatç™»å½•æ³•å’Œway03æ–¹æ³•~~ï¼‰

### æŒ‡ä»¤

- æŒ‡ä»¤çš†åªæœ‰è¶…çº§ç”¨æˆ·æˆ–è‡ªèº«å¯ç”¨

- æ›´æ–°nc

- é‡å¯nc

- æŸ¥çœ‹qq(QQ)ç‰ˆæœ¬/qqv

- ncæ£€æŸ¥æ›´æ–°

- æŸšå­æ›´æ–°ncï¼ˆè‡ªèº«ä½œä¸ºbotè§¦å‘çš„æ›´æ–°æŒ‡ä»¤ï¼‰

- æŸšå­é‡å¯ncï¼ˆè‡ªèº«ä½œä¸ºbotè§¦å‘çš„é‡å¯æŒ‡ä»¤ï¼‰

å¦‚æœä½ éœ€è¦ä½¿ç”¨`æŸšå­æ›´æ–°nc`å’Œ`æŸšå­æ›´æ–°nc`ï¼Œåˆ™åº”å½“åœ¨ncçš„è´¦å·é…ç½®æ–‡ä»¶é‡Œæ‰“å¼€è‡ªèº«æ¶ˆæ¯ä¸ŠæŠ¥(è®¾ç½®ä¸ºtrue)
```json
  "reportSelfMessage": true,
```
### é…ç½®é¡¹

> ä»¥ä¸‹é…ç½®é¡¹å¯åœ¨ `.env.*` æ–‡ä»¶ä¸­è®¾ç½®ï¼Œå…·ä½“å‚è€ƒ [NoneBot é…ç½®æ–¹å¼](https://nonebot.dev/docs/appendices/config)

#### `nc_restart_way` ï¼ˆé‡è¦æ–°å¢ï¼‰

- é»˜è®¤ï¼š`1`
- è¯´æ˜ï¼šnapcatè§¦å‘æ›´æ–°æˆ–é‡å¯æ—¶çš„é‡å¯æ–¹å¼
- å¯é€‰ï¼š

1.onebotæ¥å£çš„é‡å¯æ–¹å¼ï¼Œéƒ¨åˆ†napcatç‰ˆæœ¬æ¥å£æ˜¯åçš„ï¼Œ~~Linuxåªå¯é€‰ç”¨æ­¤æ–¹å¼ï¼ˆå› ä¸ºå…¶ä»–çš„æ²¡å†™ï¼‰~~
  
2.æ—§æ—¶ä»£ç‰ˆæœ¬napcat-utf8.batçš„å¯åŠ¨æ–¹å¼ï¼ŒQQç‰ˆæœ¬9.12ä¹‹åæ­¤æ–¹æ³•å·²å¤±æ•ˆ
  
3.way03ï¼šQQ.exeçš„å¯åŠ¨æ–¹å¼ï¼Œéœ€è¦æ›´æ”¹qqæ–‡ä»¶å¹¶é…ç½®è¡¥ä¸ï¼Œå…·ä½“å‚è€ƒ [way03å¯åŠ¨æ–¹å¼](https://napneko.github.io/zh-CN/guide/boot/shell/BootWay03)
  
4.way05ï¼šps1çš„å¯åŠ¨æ–¹å¼ï¼Œæ— éœ€æ›´æ”¹æ–‡ä»¶ä½†éœ€è¦æ›¿æ¢è¡¥ä¸ï¼Œå…·ä½“å‚è€ƒ [way05å¯åŠ¨æ–¹å¼](https://napneko.github.io/zh-CN/guide/boot/shell/BootWay05)

5.launcher-win10.batï¼šNapcat2.4.6ç‰ˆæœ¬åŠä»¥ä¸Šçš„Windows10ï¼ˆåŠä»¥ä¸‹ï¼‰çš„ç™»å½•æ–¹å¼

6.launcher.batï¼šNapcat2.4.6ç‰ˆæœ¬åŠä»¥ä¸Šçš„Windows11çš„ç™»å½•æ–¹å¼

7.xvfb-run: Linuxçš„å¯åŠ¨æ–¹æ³•ï¼Œå¿˜äº†æ˜¯å“ªä¸ªç‰ˆæœ¬å¼€å§‹æ”¯æŒçš„äº†
  
- å¿…å¡«ï¼šå¦
- è­¦å‘Šï¼š3å’Œ4çš„å¯åŠ¨æ–¹å¼åªå¯é€‰æ‹©ä¸€ä¸ªï¼ˆå› ä¸ºå¯ç”¨äº†way05åï¼Œway03æ–¹æ³•ä¼šå¤±æ•ˆï¼‰

#### `base_path`

- é»˜è®¤ï¼š`C:\\napcat`
- è¯´æ˜ï¼šnapcatè¿è¡Œç›®å½•çš„ä¸Šçº§ç›®å½•è·¯å¾„ï¼Œä¾‹å¦‚åŸè¿è¡Œäº`E:\111\NapCat.win32.x64`ï¼Œåˆ™å¡«å†™`E:\111`
- å¿…å¡«ï¼šå¦

#### `topfolder`

- é»˜è®¤ï¼š`NapCat.win32.x64`
- è¯´æ˜ï¼šnapcatè¿è¡Œç›®å½•çš„é¡¶çº§ç›®å½•åç§°ï¼Œä¾‹å¦‚åŸè¿è¡Œäº`E:\111\NapCat`ï¼Œåˆ™å¡«å†™`NapCat`
- å¿…å¡«ï¼šå¦

#### `napcat_mode`

- é»˜è®¤ï¼š`win`
- è¯´æ˜ï¼šnapcatçš„è¿è¡Œç³»ç»Ÿç±»å‹
- å¯é€‰ï¼šwinï¼Œwin_32ï¼Œlinuxï¼Œlinux_arm
- å¿…å¡«ï¼šå¦

#### `nc_proxy`

- é»˜è®¤ï¼š`false`
- è¯´æ˜ï¼šæ˜¯å¦é€šè¿‡ä»£ç†è¯·æ±‚GitHubæ›´æ–°
- å¯é€‰ï¼štrueï¼Œfalse
- å¿…å¡«ï¼šå¦

#### `nc_proxy_port`

- é»˜è®¤ï¼š`11451`
- è¯´æ˜ï¼šä»£ç†ä½¿ç”¨çš„ç«¯å£
- å¿…å¡«ï¼šå¦

#### `nc_self_update`

- é»˜è®¤ï¼š`"æŸšå­æ›´æ–°nc"`
- è¯´æ˜ï¼šå½“botæ˜¯è‡ªå·±çš„æ—¶å€™è§¦å‘çš„æ›´æ–°æŒ‡ä»¤
- å¿…å¡«ï¼šå¦

#### `nc_self_restart`

- é»˜è®¤ï¼š`"æŸšå­é‡å¯nc"`
- è¯´æ˜ï¼šå½“botæ˜¯è‡ªå·±çš„æ—¶å€™è§¦å‘çš„é‡å¯æŒ‡ä»¤
- å¿…å¡«ï¼šå¦

#### `nc_self_check_update`

- é»˜è®¤ï¼š`"æŸšå­æ£€æŸ¥æ›´æ–°"`
- è¯´æ˜ï¼šå½“botæ˜¯è‡ªå·±çš„æ—¶å€™è§¦å‘çš„æ£€æŸ¥æ›´æ–°
- å¿…å¡«ï¼šå¦

#### `nc_self_qq_version`

- é»˜è®¤ï¼š`"æŸšå­æŸ¥çœ‹qqç‰ˆæœ¬"`
- è¯´æ˜ï¼šå½“botæ˜¯è‡ªå·±çš„æ—¶å€™è§¦å‘çš„æŸ¥çœ‹qqç‰ˆæœ¬
- å¿…å¡«ï¼šå¦

#### `nc_reconnect`

- é»˜è®¤ï¼š`false`
- è¯´æ˜ï¼šæ˜¯å¦å¼€å¯napcatæ‰çº¿é‡è¿ï¼ˆç›®å‰åªæ”¯æŒWindowsï¼‰
- å¯é€‰ï¼štrueï¼Œfalse
- å¿…å¡«ï¼šå¦

### é…ç½®ç¤ºä¾‹
> åªæœ‰è¦ç”¨åˆ°çš„æ‰å¡«å†™ï¼Œå¦‚æœç”¨ä¸åˆ°æˆ–è€…ä¸çŸ¥é“æ€ä¹ˆè®¾ç½®ï¼ŒæŠŠä½ çš„napcatè¿è¡Œç›®å½•å˜æˆ`C:\napcat\NapCat.win32.x64`å°±å¯ä»¥äº†
#### Windowsé…ç½®ç¤ºä¾‹
```ini
base_path=C:\\
topfolder=NapCat
napcat_mode=win
nc_proxy=true
nc_proxy_port=11451
nc_self_update="æ©˜å­æ›´æ–°nc"
nc_self_restart="æ©˜å­é‡å¯nc"
nc_reconnect=true
nc_self_check_update="æŸšå­æ£€æŸ¥æ›´æ–°"
nc_self_qq_version="æŸšå­æŸ¥çœ‹qqç‰ˆæœ¬"
nc_restart_way=1
```
å¦‚æœä½ ä½¿ç”¨çš„æ˜¯9.9.12ç‰ˆæœ¬çš„ntqqï¼Œé‚£ä¹ˆä»–åº”è¯¥ç±»ä¼¼äºè¿™æ ·
```ini
base_path=D:\qqnt\resources\app\app_launcher
topfolder=napcat
```
#### Linuxé…ç½®ç¤ºä¾‹
```ini
base_path=/root
topfolder=NapCat.linux.x64
napcat_mode=linux
nc_proxy=true
nc_proxy_port=11451
nc_self_update="æ©˜å­æ›´æ–°nc"
nc_self_restart="æ©˜å­é‡å¯nc"
nc_reconnect=false
nc_self_check_update="æŸšå­æ£€æŸ¥æ›´æ–°"
nc_self_qq_version="æŸšå­æŸ¥çœ‹qqç‰ˆæœ¬"
nc_restart_way=1
```
## æŒ–å‘
- ~~å‡†å¤‡å®ç°linuxæ–­çº¿é‡è¿å’Œç›¸å…³åŠŸèƒ½~~
- å‡†å¤‡å¢åŠ åˆå§‹ä¸€é”®å®‰è£…napcat
- ~~å‡†å¤‡å°†æœ€æ–°çš„å¯åŠ¨æ–¹å¼åŠ è¿›å»~~
- å‡†å¤‡å¢åŠ qqæŒ‡ä»¤æ›´æ–°

## è‡´è°¢


- [Napcat](https://github.com/NapNeko/NapCatQQ)
